{% extends "staff/layout.html" %}

{% block staff_content %}
<div class="container-fluid px-4">
    <div class="row mb-3">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('staff.dashboard') }}">Home</a></li>
                    <li class="breadcrumb-item"><a href="{{ url_for('staff.news') }}">Crypto News</a></li>
                    <li class="breadcrumb-item active" aria-current="page">{{ news.title }}</li>
                </ol>
            </nav>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow-sm mb-4">
                <div class="card-body p-4 p-lg-5">
                    <h1 class="display-6 fw-bold mb-3">{{ news.title }}</h1>
                    <div class="text-muted mb-4 border-bottom pb-3">
                        <span><i class="far fa-calendar-alt me-2"></i> {{ news.created_at.strftime('%B %d, %Y')
                            }}</span>
                        <span class="mx-2">|</span>
                        <span><i class="far fa-user me-2"></i> {{ news.author.name if news.author else 'Admin' }}</span>
                        <span class="mx-2">|</span>
                        <span class="badge bg-secondary">{{ news.type|replace('_', ' ')|title }}</span>
                    </div>

                    <div class="news-content">
                        {% if news.type == 'rich_text' %}
                        {{ news.body_html|safe }}
                        {% elif news.type == 'youtube' %}
                        <div class="ratio ratio-16x9">
                            <iframe src="{{ news.content_url|youtube_embed }}" allowfullscreen></iframe>
                        </div>
                        {% elif news.type == 'video' %}
                        <div class="ratio ratio-16x9">
                            <video controls class="w-100 h-100">
                                <source src="{{ url_for('static', filename=news.file.storage_path) }}"
                                    type="{{ news.file.mime_type }}">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        {% elif news.type == 'pdf' %}
                        {% if news.file %}
                        <div style="height: 80vh; width: 100%;">
                            <iframe src="{{ url_for('static', filename=news.file.storage_path) }}" width="100%"
                                height="100%" style="border: none;">
                                <p>It appears your web browser doesn't support iframes.</p>
                            </iframe>
                        </div>
                        <div class="text-center mt-3">
                            <a href="{{ url_for('static', filename=news.file.storage_path) }}" target="_blank"
                                class="btn btn-outline-primary">
                                <i class="fas fa-external-link-alt"></i> Open in New Tab
                            </a>
                        </div>
                        {% else %}
                        <p class="text-danger">File not found.</p>
                        {% endif %}
                        {% elif news.type == 'link' %}
                        <div class="text-center py-5 bg-light rounded">
                            <i class="fas fa-external-link-alt fa-4x text-primary mb-3"></i>
                            <br>
                            <a href="{{ news.content_url }}" target="_blank" class="btn btn-lg btn-primary">Visit
                                External Link</a>
                            <p class="mt-2 text-muted">{{ news.content_url }}</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}